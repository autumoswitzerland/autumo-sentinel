# ------------------------------------------------------------
# Dynamic Code Execution / Eval Primitives
# ------------------------------------------------------------
# Should be covered by Heuristic Rules

# ------------------------------------------------------------
# Payload Download / Remote Fetch
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])(curl|wget)\b

# ------------------------------------------------------------
# Inline Script Execution (Language Interpreters)
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])(ruby)\s+-e\s
(^|[^A-Za-z0-9_\$])(python)\s+-c\s
(^|[^A-Za-z0-9_\$])(perl)\s+-0777\s+-ne\b

# ------------------------------------------------------------
# Process Spawning / Command Execution APIs
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])(spawn|spawnSync|execSync|exec)\b

# ------------------------------------------------------------
# PowerShell Execution & Abuse
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])(powershell)\b
(^|[^A-Za-z0-9_\$])(Invoke-Expression|IEX)\b
(^|[^A-Za-z0-9_\$])(certutil)\b

# ------------------------------------------------------------
# Reverse / Bind Shell Networking
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])(nc|ncat|netcat)\b

# ------------------------------------------------------------
# Persistence via Cron / SSH
# ------------------------------------------------------------
(^|[^A-Za-z0-9_\$])echo\s+.*>>\s*/etc/cron
(^|[^A-Za-z0-9_\$])ssh\s+.*authorized_keys
